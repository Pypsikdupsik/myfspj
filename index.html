<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Скачать скрипт Tampermonkey</title>
</head>
<body>
    <h2>Скачать скрипт Tampermonkey</h2>
    <a id="downloadLink" download="worksheet_preview_enhancer.user.js">Скачать скрипт</a>

    <script>
        const scriptContent = `
// ==UserScript==
// @name         Worksheet Preview Enhancer
// @namespace    http://tampermonkey.net/
// @version      1.1
// @description  Показывает ответы на worksheet-preview
// @author       YourName
// @match        *://*/*
// @grant        none
// @run-at       document-end
// ==/UserScript==

(function() {
    'use strict';

    function loadjQuery(callback) {
        if (typeof jQuery === 'undefined') {
            let script = document.createElement('script');
            script.src = 'https://code.jquery.com/jquery-3.6.0.min.js';
            script.onload = callback;
            document.head.appendChild(script);
        } else {
            callback();
        }
    }

    function waitForElement(selector, callback, timeout = 5000) {
        const startTime = Date.now();
        const interval = setInterval(function() {
            if (jQuery(selector).length) {
                clearInterval(interval);
                callback();
            } else if (Date.now() - startTime > timeout) {
                clearInterval(interval);
                console.warn(\`Элемент \${selector} не найден за \${timeout}ms\`);
            }
        }, 100);
    }

    loadjQuery(function() {
        var $ = jQuery.noConflict(true);
        waitForElement("#worksheet-preview", function() {
            if (typeof $.fn.worksheetPreview === "function") {
                $("#worksheet-preview").worksheetPreview("validation", {
                    clicked: false,
                    showAnswers: true,
                    showRightAnswers: true
                });
            } else {
                console.error("Метод worksheetPreview не найден!");
            }
        });
    });
})();
        `;

        const blob = new Blob([scriptContent], { type: 'text/javascript' });
        document.getElementById('downloadLink').href = URL.createObjectURL(blob);
    </script>
</body>
</html>
